<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]--><!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]--><!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="">
<!--<![endif]-->

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Fetch</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Simple & Efficient data access for Scala and Scala.js">
  <meta name="author" content="">
  <link rel="icon" type="image/png" href="%7B%7B%20site.favicon.url%20%7D%7D">
  <meta property="og:image" content="https://rawgit.com/47deg/microsites/cdn//fetch/poster.png">
  <meta name="twitter:image" content="https://rawgit.com/47deg/microsites/cdn//fetch/poster.png">
  <meta property="og:title" content="Fetch">
  <meta property="og:site_name" content="Fetch">
  <meta property="og:url" content="/">
  <meta property="og:type" content="website">
  <meta property="og:description" content="Simple & Efficient data access for Scala and Scala.js">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

</head>

<body>
  <!--[if IE]>
    <script src="https://cdn.jsdelivr.net/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://cdn.jsdelivr.net/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  <header id="site-header">
    <div class="navbar-wrapper">
      <div class="container">
        <div class="row">
          <div class="col-xs-6">
            <a href="#" data-href="/fetch/" class="brand">
              <div class="icon-wrapper" style="background:url('https://rawgit.com/47deg/microsites/cdn//fetch/navbar_brand.png') no-repeat"> <span>Fetch</span> </div>
            </a>
          </div>
          <div class="col-xs-6">
            <nav class="text-right">
              <ul>
                <li>
                  <a href="#" data-href="https://github.com/47deg/fetch"> <i class="fa fa-github"></i> <span class="hidden-xs">GitHub</span> </a>
                </li> 
                <li>
                  <a href="#" data-href="/fetch/docs"> <i class="fa fa-file-text"></i> <span class="hidden-xs">Documentation</span> </a>
                </li>  </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>
    <div class="jumbotron" style="background-image:url('https://rawgit.com/47deg/microsites/cdn//fetch/jumbotron_pattern.png')">
      <div class="container">
        <h1 class="text-center">Simple & Efficient data access for Scala and Scala.js</h1>
        <h2></h2>
        <p class="text-center"> <a href="#" data-href="https://github.com/47deg/fetch" class="btn btn-outline-inverse">View on GitHub</a> </p>
      </div>
    </div>
  </header>
  <main id="site-main">
    <section class="use">
      <div class="container">
        <div id="content" class="row"> <h2>Installation</h2>

<p>Add the following dependency to your project&#39;s build file.</p>

<p>For Scala 2.11.x:</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="s">"com.fortysevendeg"</span> <span class="o">%%</span> <span class="s">"fetch"</span> <span class="o">%</span> <span class="s">"0.3.0"</span>
</code></pre></div>
<p>Or, if using Scala.js (0.6.x):</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="s">"com.fortysevendeg"</span> <span class="o">%%%</span> <span class="s">"fetch"</span> <span class="o">%</span> <span class="s">"0.3.0"</span>
</code></pre></div>
<h2>Remote data</h2>

<p>Fetch is a library for making access to data both simple &amp; efficient. Fetch is especially useful when querying data that
has a latency cost, such as databases or web services.</p>

<h2>Define your data sources</h2>

<p>To tell Fetch how to get the data you want, you must implement the <code>DataSource</code> typeclass. Data sources have <code>fetchOne</code> and <code>fetchMany</code> methods that define how to fetch such a piece of data.</p>

<p>Data Sources take two type parameters:</p>

<ol>
<li><code>Identity</code> is a type that has enough information to fetch the data</li>
<li><code>Result</code> is the type of data we want to fetch</li>
</ol>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">cats.data.NonEmptyList</span>

<span class="k">trait</span> <span class="nc">DataSource</span><span class="o">[</span><span class="kt">Identity</span>, <span class="kt">Result</span><span class="o">]{</span>
  <span class="k">def</span> <span class="n">fetchOne</span><span class="o">(</span><span class="n">id</span><span class="k">:</span> <span class="kt">Identity</span><span class="o">)</span><span class="k">:</span> <span class="kt">Query</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">Result</span><span class="o">]]</span>
  <span class="k">def</span> <span class="n">fetchMany</span><span class="o">(</span><span class="n">ids</span><span class="k">:</span> <span class="kt">NonEmptyList</span><span class="o">[</span><span class="kt">Identity</span><span class="o">])</span><span class="k">:</span> <span class="kt">Query</span><span class="o">[</span><span class="kt">Map</span><span class="o">[</span><span class="kt">Identity</span>, <span class="kt">Result</span><span class="o">]]</span>
<span class="o">}</span>
</code></pre></div>
<p>Note that when we create a query we can compute its result right away, defer its evaluation or make it asynchronous. Returning <code>Query</code> instances from the fetch methods allows us to abstract from the target result type and to run it synchronously or asynchronously.</p>

<p>We&#39;ll implement a dummy data source that can convert integers to strings. For convenience, we define a <code>fetchString</code> function that lifts identities (<code>Int</code> in our dummy data source) to a <code>Fetch</code>. </p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">cats.data.NonEmptyList</span>
<span class="k">import</span> <span class="nn">cats.std.list._</span>
<span class="k">import</span> <span class="nn">fetch._</span>

<span class="k">implicit</span> <span class="k">object</span> <span class="nc">ToStringSource</span> <span class="k">extends</span> <span class="nc">DataSource</span><span class="o">[</span><span class="kt">Int</span>, <span class="kt">String</span><span class="o">]{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">fetchOne</span><span class="o">(</span><span class="n">id</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Query</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="nc">Query</span><span class="o">.</span><span class="n">sync</span><span class="o">({</span>
      <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">"[${Thread.currentThread.getId}] One ToString $id"</span><span class="o">)</span>
      <span class="nc">Option</span><span class="o">(</span><span class="n">id</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
    <span class="o">})</span>
  <span class="o">}</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">fetchMany</span><span class="o">(</span><span class="n">ids</span><span class="k">:</span> <span class="kt">NonEmptyList</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">Query</span><span class="o">[</span><span class="kt">Map</span><span class="o">[</span><span class="kt">Int</span>, <span class="kt">String</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="nc">Query</span><span class="o">.</span><span class="n">sync</span><span class="o">({</span>
      <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">"[${Thread.currentThread.getId}] Many ToString $ids"</span><span class="o">)</span>
      <span class="n">ids</span><span class="o">.</span><span class="n">unwrap</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">i</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">i</span><span class="o">.</span><span class="n">toString</span><span class="o">)).</span><span class="n">toMap</span>
    <span class="o">})</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">def</span> <span class="n">fetchString</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Fetch</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Fetch</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="c1">// or, more explicitly: Fetch(n)(ToStringSource)
</span></code></pre></div>
<h2>Creating and running a fetch</h2>

<p>Now that we can convert <code>Int</code> values to <code>Fetch[String]</code>, let&#39;s try creating a fetch.</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">fetchOne</span><span class="k">:</span> <span class="kt">Fetch</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">fetchString</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
</code></pre></div>
<p>We&#39;ll run our fetches to the ambient <code>Id</code> monad in our examples, let&#39;s do some imports.</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">cats.Id</span>
<span class="k">import</span> <span class="nn">fetch.unsafe.implicits._</span>
<span class="k">import</span> <span class="nn">fetch.syntax._</span>
</code></pre></div>
<p>Note that in real-life scenarios you&#39;ll want to run a fetch to a concurrency monad, synchronous execution of a fetch
is only supported in Scala and not Scala.js and is meant for experimentation purposes.</p>

<p>Let&#39;s run it and wait for the fetch to complete:</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">fetchOne</span><span class="o">.</span><span class="n">runA</span><span class="o">[</span><span class="kt">Id</span><span class="o">]</span>
<span class="c1">// [92] One ToString 1
// res2: cats.Id[String] = 1
</span></code></pre></div>
<p>As you can see in the previous example, the <code>ToStringSource</code> is queried once to get the value of 1.</p>

<h2>Batching</h2>

<p>Multiple fetches to the same data source are automatically batched. For illustrating it, we are going to compose three independent fetch results as a tuple.</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">cats.syntax.cartesian._</span>

<span class="k">val</span> <span class="n">fetchThree</span><span class="k">:</span> <span class="kt">Fetch</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">String</span>, <span class="kt">String</span><span class="o">)]</span> <span class="k">=</span> <span class="o">(</span><span class="n">fetchString</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">|@|</span> <span class="n">fetchString</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">|@|</span> <span class="n">fetchString</span><span class="o">(</span><span class="mi">3</span><span class="o">)).</span><span class="n">tupled</span>
</code></pre></div>
<p>When executing the above fetch, note how the three identities get batched and the data source is only queried once.</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">fetchThree</span><span class="o">.</span><span class="n">runA</span><span class="o">[</span><span class="kt">Id</span><span class="o">]</span>
<span class="c1">// [92] Many ToString OneAnd(1,List(2, 3))
// res4: cats.Id[(String, String, String)] = (1,2,3)
</span></code></pre></div>
<h2>Parallelism</h2>

<p>If we combine two independent fetches from different data sources, the fetches can be run in parallel. First, let&#39;s add a data source that fetches a string&#39;s size.</p>

<p>This time, instead of creating the results with <code>Query#sync</code> we are going to do it with <code>Query#async</code> for emulating an asynchronous data source.</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">implicit</span> <span class="k">object</span> <span class="nc">LengthSource</span> <span class="k">extends</span> <span class="nc">DataSource</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">]{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">fetchOne</span><span class="o">(</span><span class="n">id</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Query</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="nc">Query</span><span class="o">.</span><span class="n">async</span><span class="o">((</span><span class="n">ok</span><span class="o">,</span> <span class="n">fail</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
      <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">"[${Thread.currentThread.getId}] One Length $id"</span><span class="o">)</span>
      <span class="n">ok</span><span class="o">((</span><span class="nc">Option</span><span class="o">(</span><span class="n">id</span><span class="o">.</span><span class="n">size</span><span class="o">)))</span>
    <span class="o">})</span>
  <span class="o">}</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">fetchMany</span><span class="o">(</span><span class="n">ids</span><span class="k">:</span> <span class="kt">NonEmptyList</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Query</span><span class="o">[</span><span class="kt">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="nc">Query</span><span class="o">.</span><span class="n">async</span><span class="o">((</span><span class="n">ok</span><span class="o">,</span> <span class="n">fail</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
      <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">"[${Thread.currentThread.getId}] Many Length $ids"</span><span class="o">)</span>
      <span class="n">ok</span><span class="o">(</span><span class="n">ids</span><span class="o">.</span><span class="n">unwrap</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">i</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">i</span><span class="o">.</span><span class="n">size</span><span class="o">)).</span><span class="n">toMap</span><span class="o">)</span>
    <span class="o">})</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">def</span> <span class="n">fetchLength</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Fetch</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Fetch</span><span class="o">(</span><span class="n">s</span><span class="o">)</span>
</code></pre></div>
<p>And now we can easily receive data from the two sources in a single fetch. </p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">fetchMulti</span><span class="k">:</span> <span class="kt">Fetch</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">(</span><span class="n">fetchString</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">|@|</span> <span class="n">fetchLength</span><span class="o">(</span><span class="s">"one"</span><span class="o">)).</span><span class="n">tupled</span>
</code></pre></div>
<p>Note how the two independent data fetches run in parallel, minimizing the latency cost of querying the two data sources.</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">fetchMulti</span><span class="o">.</span><span class="n">runA</span><span class="o">[</span><span class="kt">Id</span><span class="o">]</span>
<span class="c1">// [92] One ToString 1
// [103] One Length one
// res6: cats.Id[(String, Int)] = (1,3)
</span></code></pre></div>
<h2>Caching</h2>

<p>When fetching an identity, subsequent fetches for the same identity are cached. Let&#39;s try creating a fetch that asks for the same identity twice.</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">fetchTwice</span><span class="k">:</span> <span class="kt">Fetch</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">)]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">one</span> <span class="k">&lt;-</span> <span class="n">fetchString</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
  <span class="n">two</span> <span class="k">&lt;-</span> <span class="n">fetchString</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="o">(</span><span class="n">one</span><span class="o">,</span> <span class="n">two</span><span class="o">)</span>
</code></pre></div>
<p>While running it, notice that the data source is only queried once. The next time the identity is requested it&#39;s served from the cache.</p>
<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">fetchTwice</span><span class="o">.</span><span class="n">runA</span><span class="o">[</span><span class="kt">Id</span><span class="o">]</span>
<span class="c1">// [92] One ToString 1
// res7: cats.Id[(String, String)] = (1,1)
</span></code></pre></div>
<hr>

<p>For more in-depth information take a look at our <a href="http://47deg.github.io/fetch/docs.html">documentation</a>.</p>
 </div>
      </div>
    </section>
    <section class="technologies">
      <div class="container">
        <div class="row">
          
            
              <div class="col-md-4">
                <div class="scala-icon-wrapper"></div>
                <h3>Scala</h3>
                <p>Fetch is written in Scala and supports both Scala (JVM) and Scala.js (JavaScript environments)</p>
              </div>
            
          
            
              <div class="col-md-4">
                <div class="cats-icon-wrapper"></div>
                <h3>Cats</h3>
                <p>Fetch uses cats' Free Monad implementation as well as some of its data types.</p>
              </div>
            
          
            
              <div class="col-md-4">
                <div class="fp-icon-wrapper"></div>
                <h3>Functional Programming</h3>
                <p>Fetch is implemented using the Free Monad and Interpreter pattern.</p>
              </div>
            
          
        </div>
      </div>
    </section>
  </main>
  <footer id="site-footer">
    <div class="container">
      <div class="row">
        <div class="col-xs-6">
          <p>Fetch is designed and developed by <a href="%7B%7B%20site.organization.url%20%7D%7D" target="_blank"></a></p>
        </div>
        <div class="col-xs-6">
          <p class="text-right">
            <a href="#" data-href="https://github.com/47deg/fetch"> <span class="fa fa-github"></span> View on Github </a>
          </p>
        </div>
      </div>
    </div>
  </footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/scala.min.js"></script>
  <script>
    jQuery(document).ready(function() {
      loadHighlight();
      loadStyle();
      hljs.initHighlightingOnLoad();
      activeLinks();
    });

    function loadStyle() {

      $("<link/>", {
        rel: "stylesheet",
        type: "text/css",
        href: "https://rawgit.com/47deg/microsites/cdn//style.css"
      }).appendTo("head");

      $("<link/>", {
        rel: "stylesheet",
        type: "text/css",
        href: "https://rawgit.com/47deg/microsites/cdn//fetch/palette.css"
      }).appendTo("head");
    }

    function loadHighlight() {
      $("<link/>", {
        rel: "stylesheet",
        type: "text/css",
        href: "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/tomorrow.min.css"
      }).appendTo("head");
    }

    function activeLinks() {
      $('a[data-href]').each(function(index, el) {
        $(this).attr('href', $(this).attr('data-href'));
      });
    }
  </script>
</body>

</html>

